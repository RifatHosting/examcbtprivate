<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureExam Pro - Platform Ujian Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-black: #000000;
            --primary-white: #ffffff;
            --gray-light: #f5f5f5;
            --gray-medium: #e0e0e0;
            --gray-dark: #757575;
            --accent: #333333;
            --danger: #ff3333;
            --success: #00cc66;
            --warning: #ffcc00;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.15);
            --radius: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--primary-white);
            color: var(--primary-black);
            line-height: 1.6;
            overflow-x: hidden;
            font-size: 16px;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 1rem;
        }

        h1 { font-size: 2.5rem; }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.75rem; }
        h4 { font-size: 1.5rem; }
        h5 { font-size: 1.25rem; }
        h6 { font-size: 1.125rem; }

        p {
            margin-bottom: 1rem;
        }

        /* Layout */
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-center {
            justify-content: center;
        }

        .grid {
            display: grid;
            gap: 1.5rem;
        }

        .grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-4 { grid-template-columns: repeat(4, 1fr); }

        /* Sections */
        .section {
            display: none;
            min-height: 100vh;
            animation: fadeIn 0.4s ease-in-out;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Header */
        header {
            background-color: var(--primary-white);
            border-bottom: 1px solid var(--gray-medium);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .header-content {
            padding: 1rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-black);
            color: var(--primary-white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: 1px solid var(--primary-black);
            background-color: var(--primary-white);
            color: var(--primary-black);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border-radius: var(--radius);
            font-size: 0.875rem;
            text-decoration: none;
        }

        .btn:hover {
            background-color: var(--primary-black);
            color: var(--primary-white);
        }

        .btn-primary {
            background-color: var(--primary-black);
            color: var(--primary-white);
        }

        .btn-primary:hover {
            background-color: var(--accent);
            border-color: var(--accent);
        }

        .btn-danger {
            background-color: var(--danger);
            color: var(--primary-white);
            border-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #ff0000;
        }

        .btn-success {
            background-color: var(--success);
            color: var(--primary-white);
            border-color: var(--success);
        }

        .btn-success:hover {
            background-color: #00aa55;
        }

        .btn-block {
            width: 100%;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--gray-medium);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--primary-white);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-black);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }

        /* Cards */
        .card {
            background-color: var(--primary-white);
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            overflow: hidden;
            transition: var(--transition);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-medium);
        }

        .card-body {
            padding: 1.5rem;
        }

        .card-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-medium);
            background-color: var(--gray-light);
        }

        /* Login Page */
        .login-container {
            display: flex;
            min-height: 100vh;
        }

        .login-left {
            flex: 1;
            background-color: var(--primary-black);
            color: var(--primary-white);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 4rem;
        }

        .login-right {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .login-form {
            width: 100%;
            max-width: 400px;
        }

        .login-title {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .login-subtitle {
            color: var(--gray-dark);
            margin-bottom: 2rem;
        }

        .user-type-toggle {
            display: flex;
            margin-bottom: 2rem;
            border: 1px solid var(--gray-medium);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .user-type-toggle button {
            flex: 1;
            padding: 0.75rem;
            background-color: var(--primary-white);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-type-toggle button.active {
            background-color: var(--primary-black);
            color: var(--primary-white);
        }

        /* Dashboard */
        .dashboard-header {
            padding: 2rem 0;
            border-bottom: 1px solid var(--gray-medium);
            margin-bottom: 2rem;
        }

        .dashboard-title {
            font-size: 1.875rem;
            margin-bottom: 0.5rem;
        }

        .dashboard-subtitle {
            color: var(--gray-dark);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background-color: var(--primary-white);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-medium);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--gray-dark);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-bottom: 2rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-medium);
        }

        th {
            background-color: var(--gray-light);
            font-weight: 600;
        }

        tr:hover {
            background-color: var(--gray-light);
        }

        /* Exam Interface */
        .exam-container {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 70px);
        }

        .exam-header {
            padding: 1rem 0;
            border-bottom: 1px solid var(--gray-medium);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .exam-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .exam-timer {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .exam-content {
            flex: 1;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .question-container {
            margin-bottom: 2rem;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .question-number {
            background-color: var(--primary-black);
            color: var(--primary-white);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .question-points {
            color: var(--gray-dark);
            font-size: 0.875rem;
        }

        .options-container {
            margin-top: 1rem;
        }

        .option {
            display: flex;
            align-items: flex-start;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid var(--gray-medium);
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .option:hover {
            background-color: var(--gray-light);
        }

        .option input[type="radio"] {
            width: auto;
            margin-right: 1rem;
            margin-top: 0.25rem;
        }

        .exam-footer {
            padding: 1rem 0;
            border-top: 1px solid var(--gray-medium);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .question-navigation {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--gray-medium);
            border-radius: var(--radius);
            background-color: var(--primary-white);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-btn:hover {
            background-color: var(--gray-light);
        }

        .nav-btn.active {
            background-color: var(--primary-black);
            color: var(--primary-white);
            border-color: var(--primary-black);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--primary-white);
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-medium);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-dark);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-medium);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Alert */
        .alert {
            padding: 1rem;
            border-radius: var(--radius);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .alert-success {
            background-color: rgba(0, 204, 102, 0.1);
            color: var(--success);
            border-left: 4px solid var(--success);
        }

        .alert-danger {
            background-color: rgba(255, 51, 51, 0.1);
            color: var(--danger);
            border-left: 4px solid var(--danger);
        }

        .alert-warning {
            background-color: rgba(255, 204, 0, 0.1);
            color: var(--warning);
            border-left: 4px solid var(--warning);
        }

        /* Ban Page */
        .ban-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 70px);
            text-align: center;
            padding: 2rem;
        }

        .ban-icon {
            font-size: 4rem;
            color: var(--danger);
            margin-bottom: 2rem;
        }

        .ban-title {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .ban-message {
            max-width: 500px;
            margin-bottom: 2rem;
            color: var(--gray-dark);
        }

        .unlock-form {
            width: 100%;
            max-width: 400px;
        }

        /* Results Page */
        .results-container {
            padding: 2rem 0;
        }

        .results-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: var(--primary-black);
            color: var(--primary-white);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .score-label {
            font-size: 0.875rem;
            font-weight: 400;
        }

        .results-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .result-item {
            text-align: center;
            padding: 1.5rem;
            background-color: var(--gray-light);
            border-radius: var(--radius);
        }

        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .result-label {
            color: var(--gray-dark);
            font-size: 0.875rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-container {
                flex-direction: column;
            }

            .login-left {
                padding: 2rem;
            }

            .grid-cols-2, .grid-cols-3, .grid-cols-4 {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .table-container {
                font-size: 0.875rem;
            }

            th, td {
                padding: 0.5rem;
            }

            .exam-footer {
                flex-direction: column;
                gap: 1rem;
            }

            .modal-content {
                width: 95%;
            }
        }

        /* Fullscreen prevention */
        .fullscreen-prevention {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            color: var(--primary-white);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .fullscreen-prevention.active {
            display: flex;
        }

        .fullscreen-message {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
            max-width: 600px;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--gray-medium);
            border-radius: 50%;
            border-top-color: var(--primary-black);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-medium);
            margin-bottom: 2rem;
        }

        .tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: var(--transition);
        }

        .tab:hover {
            background-color: var(--gray-light);
        }

        .tab.active {
            border-bottom-color: var(--primary-black);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header id="header" style="display: none;">
        <div class="container">
            <div class="header-content">
                <div class="logo">SecureExam Pro</div>
                <div class="user-info" id="userInfo" style="display: none;">
                    <div class="user-avatar" id="userAvatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <div id="userName">User</div>
                        <div id="userRole" style="font-size: 0.875rem; color: var(--gray-dark);">Role</div>
                    </div>
                    <button class="btn btn-sm" id="logoutBtn" style="margin-left: 1rem;">
                        <i class="fas fa-sign-out-alt"></i> Keluar
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Login Section -->
    <section id="loginSection" class="section active">
        <div class="login-container">
            <div class="login-left">
                <h1 style="font-size: 3rem; margin-bottom: 1rem;">SecureExam Pro</h1>
                <p style="font-size: 1.25rem; margin-bottom: 2rem;">Platform Ujian Online dengan Keamanan Tinggi</p>
                <p style="max-width: 500px; line-height: 1.7;">Sistem ujian online yang dirancang dengan keamanan maksimal untuk mencegah kecurangan dan memastikan integritas hasil ujian.</p>
            </div>
            <div class="login-right">
                <div class="login-form">
                    <div class="user-type-toggle">
                        <button id="studentTab" class="active">Siswa</button>
                        <button id="adminTab">Admin</button>
                    </div>
                    <h2 class="login-title">Masuk ke Akun Anda</h2>
                    <p class="login-subtitle">Masukkan kredensial Anda untuk melanjutkan</p>
                    <div id="loginAlert"></div>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" name="username" placeholder="Masukkan username" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" name="password" placeholder="Masukkan password" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-sign-in-alt"></i> Masuk
                        </button>
                    </form>
                    <div style="text-align: center; margin-top: 2rem; color: var(--gray-dark); font-size: 0.875rem;">
                        <p>Demo Siswa: siswa / password123</p>
                        <p>Demo Admin: admin / admin123</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Dashboard Section -->
    <section id="adminDashboardSection" class="section">
        <div class="container">
            <div class="dashboard-header">
                <div>
                    <h1 class="dashboard-title">Dashboard Admin</h1>
                    <p class="dashboard-subtitle">Kelola ujian dan pengguna</p>
                </div>
                <div>
                    <button class="btn" id="currentTime"></button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">Total Pengguna</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalExams">0</div>
                    <div class="stat-label">Total Ujian</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalAttempts">0</div>
                    <div class="stat-label">Total Percobaan</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgScore">0%</div>
                    <div class="stat-label">Rata-rata Nilai</div>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" data-tab="exams">Kelola Ujian</div>
                <div class="tab" data-tab="users">Kelola Pengguna</div>
                <div class="tab" data-tab="results">Hasil Ujian</div>
            </div>

            <!-- Exams Tab -->
            <div class="tab-content active" id="examsTab">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2>Daftar Ujian</h2>
                    <button class="btn btn-primary" id="addExamBtn">
                        <i class="fas fa-plus"></i> Tambah Ujian
                    </button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nama Ujian</th>
                                <th>Mata Pelajaran</th>
                                <th>Durasi</th>
                                <th>Jumlah Soal</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="examsTableBody">
                            <!-- Exam rows will be added dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Users Tab -->
            <div class="tab-content" id="usersTab">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2>Daftar Pengguna</h2>
                    <button class="btn btn-primary" id="addUserBtn">
                        <i class="fas fa-plus"></i> Tambah Pengguna
                    </button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Nama Lengkap</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- User rows will be added dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Results Tab -->
            <div class="tab-content" id="resultsTab">
                <h2>Hasil Ujian</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nama Siswa</th>
                                <th>Ujian</th>
                                <th>Tanggal</th>
                                <th>Nilai</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTableBody">
                            <!-- Result rows will be added dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Student Dashboard Section -->
    <section id="studentDashboardSection" class="section">
        <div class="container">
            <div class="dashboard-header">
                <div>
                    <h1 class="dashboard-title">Dashboard Siswa</h1>
                    <p class="dashboard-subtitle">Pilih ujian yang tersedia</p>
                </div>
                <div>
                    <button class="btn" id="studentCurrentTime"></button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="studentTotalExams">0</div>
                    <div class="stat-label">Ujian Tersedia</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="studentCompletedExams">0</div>
                    <div class="stat-label">Ujian Selesai</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="studentAvgScore">0%</div>
                    <div class="stat-label">Rata-rata Nilai</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="studentRank">-</div>
                    <div class="stat-label">Peringkat</div>
                </div>
            </div>

            <h2 style="margin-bottom: 1.5rem;">Ujian Tersedia</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3" id="availableExams">
                <!-- Exam cards will be added dynamically -->
            </div>

            <h2 style="margin: 2rem 0 1.5rem;">Riwayat Ujian</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Ujian</th>
                            <th>Tanggal</th>
                            <th>Nilai</th>
                            <th>Status</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="studentHistoryTableBody">
                        <!-- History rows will be added dynamically -->
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Exam Section -->
    <section id="examSection" class="section">
        <div class="exam-container">
            <div class="container">
                <div class="exam-header">
                    <div>
                        <h1 class="exam-title" id="examTitle">Judul Ujian</h1>
                        <p id="examSubtitle">Subjudul Ujian</p>
                    </div>
                    <div class="exam-timer">
                        <i class="fas fa-clock"></i>
                        <span id="timerDisplay">60:00</span>
                    </div>
                </div>
                
                <div class="exam-content">
                    <div class="question-container">
                        <div class="question-header">
                            <span class="question-number" id="questionNumber">Pertanyaan 1</span>
                            <span class="question-points" id="questionPoints">5 poin</span>
                        </div>
                        <div id="questionText">
                            Ini adalah contoh pertanyaan. Mana jawaban yang benar?
                        </div>
                        <div class="options-container" id="optionsContainer">
                            <div class="option">
                                <input type="radio" id="option1" name="answer" value="a">
                                <label for="option1">Opsi A</label>
                            </div>
                            <div class="option">
                                <input type="radio" id="option2" name="answer" value="b">
                                <label for="option2">Opsi B</label>
                            </div>
                            <div class="option">
                                <input type="radio" id="option3" name="answer" value="c">
                                <label for="option3">Opsi C</label>
                            </div>
                            <div class="option">
                                <input type="radio" id="option4" name="answer" value="d">
                                <label for="option4">Opsi D</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="exam-footer">
                    <div class="question-navigation" id="questionNavigation">
                        <!-- Question navigation buttons will be generated dynamically -->
                    </div>
                    <div>
                        <button id="prevQuestionBtn" class="btn" disabled>
                            <i class="fas fa-chevron-left"></i> Sebelumnya
                        </button>
                        <button id="nextQuestionBtn" class="btn">
                            Selanjutnya <i class="fas fa-chevron-right"></i>
                        </button>
                        <button id="submitExamBtn" class="btn btn-primary" style="display: none;">
                            <i class="fas fa-paper-plane"></i> Kirim Ujian
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="section">
        <div class="container">
            <div class="results-container">
                <div class="results-header">
                    <h1>Hasil Ujian</h1>
                    <p id="examName">Nama Ujian</p>
                </div>
                
                <div class="score-circle">
                    <span id="scorePercentage">85%</span>
                    <span class="score-label">NILAI</span>
                </div>
                
                <div class="results-details">
                    <div class="result-item">
                        <div class="result-value" id="totalQuestions">30</div>
                        <div class="result-label">Total Soal</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value" id="correctAnswers">25</div>
                        <div class="result-label">Jawaban Benar</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value" id="incorrectAnswers">5</div>
                        <div class="result-label">Jawaban Salah</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value" id="timeTaken">45 menit</div>
                        <div class="result-label">Waktu Pengerjaan</div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button id="backToDashboardBtn" class="btn btn-block">
                        <i class="fas fa-home"></i> Kembali ke Dashboard
                    </button>
                    <button id="retakeExamBtn" class="btn btn-block">
                        <i class="fas fa-redo"></i> Ulangi Ujian
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Ban Section -->
    <section id="banSection" class="section">
        <div class="ban-container">
            <div class="ban-icon">
                <i class="fas fa-ban"></i>
            </div>
            <h1 class="ban-title">Akun Diblokir</h1>
            <div class="ban-message">
                <p>Akun Anda telah diblokir karena melanggar aturan ujian.</p>
                <p>Untuk membuka blokir, masukkan kode registrasi yang diberikan oleh administrator.</p>
            </div>
            <div class="card unlock-form">
                <div id="banAlert"></div>
                <form id="unlockForm">
                    <div class="form-group">
                        <label for="unlockCode">Kode Registrasi</label>
                        <input type="text" id="unlockCode" placeholder="Masukkan kode registrasi" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-unlock"></i> Buka Blokir
                    </button>
                </form>
                <div style="text-align: center; margin-top: 1.5rem; color: var(--gray-dark); font-size: 0.875rem;">
                    <p>Demo kode buka blokir: UNLOCK123</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Fullscreen Prevention -->
    <div class="fullscreen-prevention" id="fullscreenPrevention">
        <div class="fullscreen-message">
            <h2>Terdeteksi Percobaan Kecurangan</h2>
            <p>Anda mencoba keluar dari mode ujian atau membuka aplikasi lain. Ini adalah pelanggaran aturan ujian.</p>
            <p>Anda akan dikembalikan ke ujian dalam <span id="countdown">10</span> detik.</p>
        </div>
    </div>

    <!-- Exit Code Modal -->
    <div class="modal" id="exitCodeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Kode Keluar Ujian</h3>
                <button class="modal-close" id="closeExitModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Untuk keluar dari ujian, masukkan kode keamanan yang diberikan oleh pengawas.</p>
                <div class="form-group">
                    <label for="exitCode">Kode Keamanan</label>
                    <input type="text" id="exitCode" placeholder="Masukkan kode keamanan">
                </div>
                <div id="exitCodeAlert"></div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelExitBtn">Batal</button>
                <button class="btn btn-primary" id="confirmExitBtn">Keluar</button>
            </div>
        </div>
    </div>

    <!-- Add Exam Modal -->
    <div class="modal" id="addExamModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Tambah Ujian Baru</h3>
                <button class="modal-close" id="closeAddExamModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addExamForm">
                    <div class="form-group">
                        <label for="examName">Nama Ujian</label>
                        <input type="text" id="examName" placeholder="Masukkan nama ujian" required>
                    </div>
                    <div class="form-group">
                        <label for="examSubject">Mata Pelajaran</label>
                        <input type="text" id="examSubject" placeholder="Masukkan mata pelajaran" required>
                    </div>
                    <div class="form-group">
                        <label for="examDuration">Durasi (menit)</label>
                        <input type="number" id="examDuration" placeholder="Masukkan durasi dalam menit" required>
                    </div>
                    <div class="form-group">
                        <label for="examQuestions">Jumlah Soal</label>
                        <input type="number" id="examQuestions" placeholder="Masukkan jumlah soal" required>
                    </div>
                    <div id="addExamAlert"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelAddExamBtn">Batal</button>
                <button class="btn btn-primary" id="saveExamBtn">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Tambah Pengguna Baru</h3>
                <button class="modal-close" id="closeAddUserModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addUserForm">
                    <div class="form-group">
                        <label for="newUsername">Username</label>
                        <input type="text" id="newUsername" placeholder="Masukkan username" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">Password</label>
                        <input type="password" id="newPassword" placeholder="Masukkan password" required>
                    </div>
                    <div class="form-group">
                        <label for="fullName">Nama Lengkap</label>
                        <input type="text" id="fullName" placeholder="Masukkan nama lengkap" required>
                    </div>
                    <div class="form-group">
                        <label for="userRole">Role</label>
                        <select id="userRole" required>
                            <option value="">Pilih role</option>
                            <option value="admin">Admin</option>
                            <option value="siswa">Siswa</option>
                        </select>
                    </div>
                    <div id="addUserAlert"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelAddUserBtn">Batal</button>
                <button class="btn btn-primary" id="saveUserBtn">Simpan</button>
            </div>
        </div>
    </div>

    <script>
        // Application State
        const appState = {
            currentUser: null,
            currentUserRole: null,
            currentExam: null,
            currentQuestion: 0,
            examAnswers: {},
            violations: 0,
            isBanned: false,
            examTimer: null,
            examStartTime: null,
            examEndTime: null,
            examHistory: [],
            users: [],
            exams: [],
            results: []
        };

        // Mock Database
        const mockUsers = [
            { id: 1, username: 'admin', password: 'admin123', fullName: 'Administrator', role: 'admin', status: 'active' },
            { id: 2, username: 'siswa', password: 'password123', fullName: 'Siswa Contoh', role: 'siswa', status: 'active' }
        ];

        const mockExams = [
            {
                id: 1,
                name: 'Ujian Matematika Dasar',
                subject: 'Matematika',
                duration: 60,
                questions: [
                    {
                        question: 'Berapa hasil dari 15 + 25?',
                        options: ['30', '35', '40', '45'],
                        correctAnswer: 2,
                        points: 5
                    },
                    {
                        question: 'Berapa hasil dari 7 × 8?',
                        options: ['48', '54', '56', '64'],
                        correctAnswer: 2,
                        points: 5
                    },
                    {
                        question: 'Berapa hasil dari 100 ÷ 5?',
                        options: ['15', '20', '25', '30'],
                        correctAnswer: 1,
                        points: 5
                    },
                    {
                        question: 'Berapa hasil dari 12²?',
                        options: ['120', '144', '168', '196'],
                        correctAnswer: 1,
                        points: 5
                    },
                    {
                        question: 'Berapa akar kuadrat dari 144?',
                        options: ['10', '11', '12', '13'],
                        correctAnswer: 2,
                        points: 5
                    }
                ]
            },
            {
                id: 2,
                name: 'Ujian Bahasa Indonesia',
                subject: 'Bahasa Indonesia',
                duration: 45,
                questions: [
                    {
                        question: '"Saya belajar bahasa Indonesia setiap hari." Kalimat tersebut termasuk jenis kalimat...',
                        options: ['Berita', 'Tanya', 'Perintah', 'Seru'],
                        correctAnswer: 0,
                        points: 5
                    },
                    {
                        question: 'Manakah yang bukan merupakan kata kerja?',
                        options: ['Berlari', 'Membaca', 'Meja', 'Menulis'],
                        correctAnswer: 2,
                        points: 5
                    },
                    {
                        question: '"Anak itu cerdas." Kata "cerdas" dalam kalimat tersebut berfungsi sebagai...',
                        options: ['Subjek', 'Predikat', 'Objek', 'Keterangan'],
                        correctAnswer: 1,
                        points: 5
                    },
                    {
                        question: 'Manakah yang bukan merupakan unsur kebahasaan?',
                        options: ['Morfologi', 'Sintaksis', 'Semantik', 'Biologi'],
                        correctAnswer: 3,
                        points: 5
                    },
                    {
                        question: '"Buku itu dibaca oleh Andi." Kalimat tersebut termasuk jenis kalimat...',
                        options: ['Aktif', 'Pasif', 'Interrogatif', 'Imperatif'],
                        correctAnswer: 1,
                        points: 5
                    }
                ]
            }
        ];

        // Initialize data from localStorage or use mock data
        function initializeData() {
            // Load users
            const savedUsers = localStorage.getItem('examUsers');
            if (savedUsers) {
                appState.users = JSON.parse(savedUsers);
            } else {
                appState.users = [...mockUsers];
                saveUsersToStorage();
            }

            // Load exams
            const savedExams = localStorage.getItem('examExams');
            if (savedExams) {
                appState.exams = JSON.parse(savedExams);
            } else {
                appState.exams = [...mockExams];
                saveExamsToStorage();
            }

            // Load results
            const savedResults = localStorage.getItem('examResults');
            if (savedResults) {
                appState.results = JSON.parse(savedResults);
            } else {
                appState.results = [];
                saveResultsToStorage();
            }
        }

        // Save data to localStorage
        function saveUsersToStorage() {
            localStorage.setItem('examUsers', JSON.stringify(appState.users));
        }

        function saveExamsToStorage() {
            localStorage.setItem('examExams', JSON.stringify(appState.exams));
        }

        function saveResultsToStorage() {
            localStorage.setItem('examResults', JSON.stringify(appState.results));
        }

        // DOM Elements
        const sections = {
            login: document.getElementById('loginSection'),
            adminDashboard: document.getElementById('adminDashboardSection'),
            studentDashboard: document.getElementById('studentDashboardSection'),
            exam: document.getElementById('examSection'),
            results: document.getElementById('resultsSection'),
            ban: document.getElementById('banSection')
        };

        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const userRole = document.getElementById('userRole');
        const userAvatar = document.getElementById('userAvatar');
        const header = document.getElementById('header');
        const fullscreenPrevention = document.getElementById('fullscreenPrevention');
        const exitCodeModal = document.getElementById('exitCodeModal');
        const addExamModal = document.getElementById('addExamModal');
        const addUserModal = document.getElementById('addUserModal');

        // Utility Functions
        function showSection(sectionName) {
            Object.keys(sections).forEach(key => {
                sections[key].classList.remove('active');
            });
            sections[sectionName].classList.add('active');
            
            // Show/hide header based on section
            if (sectionName === 'login') {
                header.style.display = 'none';
            } else {
                header.style.display = 'block';
            }
        }

        function showAlert(containerId, message, type) {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div class="alert alert-${type}">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'danger' ? 'exclamation-circle' : 'exclamation-triangle'}"></i>
                    ${message}
                </div>
            `;
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('id-ID', { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit'
            });
            const dateString = now.toLocaleDateString('id-ID', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            const currentTimeElement = document.getElementById('currentTime');
            if (currentTimeElement) {
                currentTimeElement.textContent = `${dateString} ${timeString}`;
            }
            
            const studentCurrentTimeElement = document.getElementById('studentCurrentTime');
            if (studentCurrentTimeElement) {
                studentCurrentTimeElement.textContent = `${dateString} ${timeString}`;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize data
            initializeData();
            
            // Update current time every second
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            
            // Check if user is already logged in (in a real app, this would check session/token)
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                appState.currentUser = JSON.parse(savedUser);
                const savedRole = localStorage.getItem('currentUserRole');
                appState.currentUserRole = savedRole;
                updateUserInfo();
                
                if (appState.currentUserRole === 'admin') {
                    showSection('adminDashboard');
                    loadAdminDashboard();
                } else {
                    showSection('studentDashboard');
                    loadStudentDashboard();
                }
            }
            
            // Check if user is banned
            const isBanned = localStorage.getItem('isBanned') === 'true';
            if (isBanned) {
                appState.isBanned = true;
                showSection('ban');
            }
        });

        // Update User Info in Header
        function updateUserInfo() {
            if (appState.currentUser) {
                userInfo.style.display = 'flex';
                userName.textContent = appState.currentUser.fullName;
                userRole.textContent = appState.currentUserRole === 'admin' ? 'Administrator' : 'Siswa';
                userAvatar.innerHTML = appState.currentUser.fullName.charAt(0).toUpperCase();
            } else {
                userInfo.style.display = 'none';
            }
        }

        // User Type Toggle
        document.getElementById('studentTab').addEventListener('click', () => {
            document.getElementById('studentTab').classList.add('active');
            document.getElementById('adminTab').classList.remove('active');
        });

        document.getElementById('adminTab').addEventListener('click', () => {
            document.getElementById('adminTab').classList.add('active');
            document.getElementById('studentTab').classList.remove('active');
        });

        // Login Form Handler
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const isAdmin = document.getElementById('adminTab').classList.contains('active');
            
            // Validate credentials against database
            const user = appState.users.find(u => 
                u.username === username && 
                u.password === password && 
                u.role === (isAdmin ? 'admin' : 'siswa') &&
                u.status === 'active'
            );
            
            if (user) {
                appState.currentUser = user;
                appState.currentUserRole = user.role;
                localStorage.setItem('currentUser', JSON.stringify(user));
                localStorage.setItem('currentUserRole', user.role);
                updateUserInfo();
                
                if (user.role === 'admin') {
                    showSection('adminDashboard');
                    loadAdminDashboard();
                } else {
                    showSection('studentDashboard');
                    loadStudentDashboard();
                }
            } else {
                showAlert('loginAlert', 'Username atau password salah. Silakan coba lagi.', 'danger');
            }
        });

        // Logout Handler
        document.getElementById('logoutBtn').addEventListener('click', () => {
            appState.currentUser = null;
            appState.currentUserRole = null;
            localStorage.removeItem('currentUser');
            localStorage.removeItem('currentUserRole');
            updateUserInfo();
            showSection('login');
        });

        // Load Admin Dashboard
        function loadAdminDashboard() {
            // Update stats
            document.getElementById('totalUsers').textContent = appState.users.filter(u => u.role === 'siswa').length;
            document.getElementById('totalExams').textContent = appState.exams.length;
            document.getElementById('totalAttempts').textContent = appState.results.length;
            
            // Calculate average score
            if (appState.results.length > 0) {
                const totalScore = appState.results.reduce((sum, result) => sum + result.score, 0);
                const avgScore = Math.round(totalScore / appState.results.length);
                document.getElementById('avgScore').textContent = `${avgScore}%`;
            } else {
                document.getElementById('avgScore').textContent = '0%';
            }
            
            // Load exams table
            loadExamsTable();
            
            // Load users table
            loadUsersTable();
            
            // Load results table
            loadResultsTable();
        }

        // Load Exams Table
        function loadExamsTable() {
            const tableBody = document.getElementById('examsTableBody');
            tableBody.innerHTML = '';
            
            appState.exams.forEach(exam => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${exam.id}</td>
                    <td>${exam.name}</td>
                    <td>${exam.subject}</td>
                    <td>${exam.duration} menit</td>
                    <td>${exam.questions.length}</td>
                    <td>
                        <button class="btn btn-sm edit-exam-btn" data-id="${exam.id}">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-sm btn-danger delete-exam-btn" data-id="${exam.id}">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-exam-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const examId = parseInt(e.currentTarget.getAttribute('data-id'));
                    editExam(examId);
                });
            });
            
            document.querySelectorAll('.delete-exam-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const examId = parseInt(e.currentTarget.getAttribute('data-id'));
                    deleteExam(examId);
                });
            });
        }

        // Load Users Table
        function loadUsersTable() {
            const tableBody = document.getElementById('usersTableBody');
            tableBody.innerHTML = '';
            
            appState.users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.username}</td>
                    <td>${user.fullName}</td>
                    <td>${user.role === 'admin' ? 'Administrator' : 'Siswa'}</td>
                    <td>${user.status === 'active' ? 'Aktif' : 'Tidak Aktif'}</td>
                    <td>
                        <button class="btn btn-sm edit-user-btn" data-id="${user.id}">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-sm btn-danger delete-user-btn" data-id="${user.id}">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-user-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const userId = parseInt(e.currentTarget.getAttribute('data-id'));
                    editUser(userId);
                });
            });
            
            document.querySelectorAll('.delete-user-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const userId = parseInt(e.currentTarget.getAttribute('data-id'));
                    deleteUser(userId);
                });
            });
        }

        // Load Results Table
        function loadResultsTable() {
            const tableBody = document.getElementById('resultsTableBody');
            tableBody.innerHTML = '';
            
            appState.results.forEach(result => {
                const user = appState.users.find(u => u.id === result.userId);
                const exam = appState.exams.find(e => e.id === result.examId);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${result.id}</td>
                    <td>${user ? user.fullName : 'Unknown'}</td>
                    <td>${exam ? exam.name : 'Unknown'}</td>
                    <td>${new Date(result.date).toLocaleDateString('id-ID')}</td>
                    <td>${result.score}%</td>
                    <td>${result.status}</td>
                    <td>
                        <button class="btn btn-sm view-result-btn" data-id="${result.id}">
                            <i class="fas fa-eye"></i> Lihat
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Add event listeners for view buttons
            document.querySelectorAll('.view-result-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const resultId = parseInt(e.currentTarget.getAttribute('data-id'));
                    viewResult(resultId);
                });
            });
        }

        // Load Student Dashboard
        function loadStudentDashboard() {
            // Update stats
            document.getElementById('studentTotalExams').textContent = appState.exams.length;
            
            const studentResults = appState.results.filter(r => r.userId === appState.currentUser.id);
            document.getElementById('studentCompletedExams').textContent = studentResults.length;
            
            // Calculate average score
            if (studentResults.length > 0) {
                const totalScore = studentResults.reduce((sum, result) => sum + result.score, 0);
                const avgScore = Math.round(totalScore / studentResults.length);
                document.getElementById('studentAvgScore').textContent = `${avgScore}%`;
            } else {
                document.getElementById('studentAvgScore').textContent = '0%';
            }
            
            // Calculate rank (simplified)
            document.getElementById('studentRank').textContent = '-';
            
            // Load available exams
            loadAvailableExams();
            
            // Load exam history
            loadStudentHistory();
        }

        // Load Available Exams
        function loadAvailableExams() {
            const container = document.getElementById('availableExams');
            container.innerHTML = '';
            
            appState.exams.forEach(exam => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${exam.name}</h3>
                    </div>
                    <div class="card-body">
                        <p><strong>Mata Pelajaran:</strong> ${exam.subject}</p>
                        <p><strong>Durasi:</strong> ${exam.duration} menit</p>
                        <p><strong>Jumlah Soal:</strong> ${exam.questions.length}</p>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-primary btn-block start-exam-btn" data-id="${exam.id}">
                            <i class="fas fa-play"></i> Mulai Ujian
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
            
            // Add event listeners for start exam buttons
            document.querySelectorAll('.start-exam-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const examId = parseInt(e.currentTarget.getAttribute('data-id'));
                    startExam(examId);
                });
            });
        }

        // Load Student History
        function loadStudentHistory() {
            const tableBody = document.getElementById('studentHistoryTableBody');
            tableBody.innerHTML = '';
            
            const studentResults = appState.results.filter(r => r.userId === appState.currentUser.id);
            
            if (studentResults.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center;">Tidak ada riwayat ujian</td>`;
                tableBody.appendChild(row);
                return;
            }
            
            studentResults.forEach(result => {
                const exam = appState.exams.find(e => e.id === result.examId);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${result.id}</td>
                    <td>${exam ? exam.name : 'Unknown'}</td>
                    <td>${new Date(result.date).toLocaleDateString('id-ID')}</td>
                    <td>${result.score}%</td>
                    <td>${result.status}</td>
                    <td>
                        <button class="btn btn-sm view-result-btn" data-id="${result.id}">
                            <i class="fas fa-eye"></i> Lihat
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Add event listeners for view buttons
            document.querySelectorAll('#studentHistoryTableBody .view-result-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const resultId = parseInt(e.currentTarget.getAttribute('data-id'));
                    viewResult(resultId);
                });
            });
        }

        // Tab Navigation
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                const tabName = e.currentTarget.getAttribute('data-tab');
                
                // Update active tab
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                e.currentTarget.classList.add('active');
                
                // Show corresponding content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`${tabName}Tab`).classList.add('active');
            });
        });

        // Add Exam Modal
        document.getElementById('addExamBtn').addEventListener('click', () => {
            addExamModal.classList.add('active');
        });

        document.getElementById('closeAddExamModal').addEventListener('click', () => {
            addExamModal.classList.remove('active');
        });

        document.getElementById('cancelAddExamBtn').addEventListener('click', () => {
            addExamModal.classList.remove('active');
        });

        document.getElementById('saveExamBtn').addEventListener('click', () => {
            const name = document.getElementById('examName').value;
            const subject = document.getElementById('examSubject').value;
            const duration = parseInt(document.getElementById('examDuration').value);
            const questionsCount = parseInt(document.getElementById('examQuestions').value);
            
            if (!name || !subject || !duration || !questionsCount) {
                showAlert('addExamAlert', 'Semua field harus diisi', 'danger');
                return;
            }
            
            // Generate new exam with placeholder questions
            const newExam = {
                id: appState.exams.length + 1,
                name,
                subject,
                duration,
                questions: []
            };
            
            // Generate placeholder questions
            for (let i = 0; i < questionsCount; i++) {
                newExam.questions.push({
                    question: `Pertanyaan ${i + 1}`,
                    options: ['Opsi A', 'Opsi B', 'Opsi C', 'Opsi D'],
                    correctAnswer: 0,
                    points: 5
                });
            }
            
            appState.exams.push(newExam);
            saveExamsToStorage();
            loadExamsTable();
            
            // Reset form
            document.getElementById('addExamForm').reset();
            addExamModal.classList.remove('active');
            
            showAlert('addExamAlert', 'Ujian berhasil ditambahkan', 'success');
        });

        // Add User Modal
        document.getElementById('addUserBtn').addEventListener('click', () => {
            addUserModal.classList.add('active');
        });

        document.getElementById('closeAddUserModal').addEventListener('click', () => {
            addUserModal.classList.remove('active');
        });

        document.getElementById('cancelAddUserBtn').addEventListener('click', () => {
            addUserModal.classList.remove('active');
        });

        document.getElementById('saveUserBtn').addEventListener('click', () => {
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const fullName = document.getElementById('fullName').value;
            const role = document.getElementById('userRole').value;
            
            if (!username || !password || !fullName || !role) {
                showAlert('addUserAlert', 'Semua field harus diisi', 'danger');
                return;
            }
            
            // Check if username already exists
            if (appState.users.some(u => u.username === username)) {
                showAlert('addUserAlert', 'Username sudah digunakan', 'danger');
                return;
            }
            
            const newUser = {
                id: appState.users.length + 1,
                username,
                password,
                fullName,
                role,
                status: 'active'
            };
            
            appState.users.push(newUser);
            saveUsersToStorage();
            loadUsersTable();
            
            // Reset form
            document.getElementById('addUserForm').reset();
            addUserModal.classList.remove('active');
            
            showAlert('addUserAlert', 'Pengguna berhasil ditambahkan', 'success');
        });

        // Start Exam Function
        function startExam(examId) {
            const exam = appState.exams.find(e => e.id === examId);
            if (!exam) return;
            
            // Initialize exam state
            appState.currentExam = examId;
            appState.currentQuestion = 0;
            appState.examAnswers = {};
            appState.violations = 0;
            appState.examStartTime = new Date();
            
            // Load exam data
            loadExam(exam);
            
            // Set up anti-cheating mechanisms
            setupAntiCheating();
            
            // Show exam section
            showSection('exam');
        }

        // Load Exam Data
        function loadExam(exam) {
            // Update exam header
            document.getElementById('examTitle').textContent = exam.name;
            document.getElementById('examSubtitle').textContent = exam.subject;
            
            // Initialize timer
            let timeRemaining = exam.duration * 60; // Convert to seconds
            updateTimerDisplay(timeRemaining);
            
            // Start exam timer
            appState.examTimer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay(timeRemaining);
                
                if (timeRemaining <= 0) {
                    // Time's up - submit exam automatically
                    submitExam();
                }
            }, 1000);
            
            // Generate question navigation
            generateQuestionNavigation(exam.questions.length);
            
            // Load first question
            loadQuestion(0);
        }

        // Update Timer Display
        function updateTimerDisplay(seconds) {
            document.getElementById('timerDisplay').textContent = formatTime(seconds);
        }

        // Generate Question Navigation
        function generateQuestionNavigation(questionCount) {
            const navigation = document.getElementById('questionNavigation');
            navigation.innerHTML = '';
            
            for (let i = 0; i < questionCount; i++) {
                const navBtn = document.createElement('button');
                navBtn.className = 'nav-btn';
                navBtn.textContent = i + 1;
                navBtn.addEventListener('click', () => {
                    saveCurrentAnswer();
                    loadQuestion(i);
                });
                
                if (i === 0) {
                    navBtn.classList.add('active');
                }
                
                navigation.appendChild(navBtn);
            }
        }

        // Load Question
        function loadQuestion(questionIndex) {
            const exam = appState.exams.find(e => e.id === appState.currentExam);
            if (!exam) return;
            
            const question = exam.questions[questionIndex];
            
            // Update question number
            document.getElementById('questionNumber').textContent = `Pertanyaan ${questionIndex + 1}`;
            document.getElementById('questionPoints').textContent = `${question.points} poin`;
            
            // Update question text
            document.getElementById('questionText').textContent = question.question;
            
            // Update options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                
                const optionId = `option${index}`;
                const input = document.createElement('input');
                input.type = 'radio';
                input.id = optionId;
                input.name = 'answer';
                input.value = index;
                
                // Check if this answer was previously selected
                if (appState.examAnswers[questionIndex] === index) {
                    input.checked = true;
                }
                
                const label = document.createElement('label');
                label.htmlFor = optionId;
                label.textContent = option;
                
                optionDiv.appendChild(input);
                optionDiv.appendChild(label);
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update navigation buttons
            updateNavigationButtons(questionIndex, exam.questions.length);
            
            // Update active navigation button
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach((btn, index) => {
                btn.classList.toggle('active', index === questionIndex);
            });
            
            // Update current question index
            appState.currentQuestion = questionIndex;
        }

        // Save Current Answer
        function saveCurrentAnswer() {
            const selectedOption = document.querySelector('input[name="answer"]:checked');
            if (selectedOption) {
                appState.examAnswers[appState.currentQuestion] = parseInt(selectedOption.value);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(currentIndex, totalQuestions) {
            const prevBtn = document.getElementById('prevQuestionBtn');
            const nextBtn = document.getElementById('nextQuestionBtn');
            const submitBtn = document.getElementById('submitExamBtn');
            
            // Previous button
            prevBtn.disabled = currentIndex === 0;
            
            // Next/Submit button
            if (currentIndex === totalQuestions - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-flex';
            } else {
                nextBtn.style.display = 'inline-flex';
                submitBtn.style.display = 'none';
            }
        }

        // Previous Question Handler
        document.getElementById('prevQuestionBtn').addEventListener('click', () => {
            saveCurrentAnswer();
            loadQuestion(appState.currentQuestion - 1);
        });

        // Next Question Handler
        document.getElementById('nextQuestionBtn').addEventListener('click', () => {
            saveCurrentAnswer();
            loadQuestion(appState.currentQuestion + 1);
        });

        // Submit Exam Handler
        document.getElementById('submitExamBtn').addEventListener('click', () => {
            if (confirm('Apakah Anda yakin ingin mengirim ujian? Anda tidak dapat mengubah jawaban setelah pengiriman.')) {
                submitExam();
            }
        });

        // Submit Exam Function
        function submitExam() {
            // Save current answer
            saveCurrentAnswer();
            
            // Clear exam timer
            clearInterval(appState.examTimer);
            
            // Record end time
            appState.examEndTime = new Date();
            
            // Calculate results
            const results = calculateResults();
            
            // Add to results
            const newResult = {
                id: appState.results.length + 1,
                userId: appState.currentUser.id,
                examId: appState.currentExam,
                date: new Date().toISOString(),
                score: results.percentage,
                status: results.percentage >= 60 ? 'Lulus' : 'Tidak Lulus',
                answers: appState.examAnswers,
                violations: appState.violations
            };
            
            appState.results.push(newResult);
            saveResultsToStorage();
            
            // Remove anti-cheating event listeners
            removeAntiCheating();
            
            // Display results
            displayResults(results);
            
            // Show results section
            showSection('results');
        }

        // Calculate Results
        function calculateResults() {
            const exam = appState.exams.find(e => e.id === appState.currentExam);
            if (!exam) return { percentage: 0, correct: 0, incorrect: 0, total: 0 };
            
            let correctAnswers = 0;
            let totalPoints = 0;
            let earnedPoints = 0;
            
            exam.questions.forEach((question, index) => {
                totalPoints += question.points;
                
                if (appState.examAnswers[index] === question.correctAnswer) {
                    correctAnswers++;
                    earnedPoints += question.points;
                }
            });
            
            const percentage = Math.round((earnedPoints / totalPoints) * 100);
            
            // Calculate time taken
            const timeTakenMs = appState.examEndTime - appState.examStartTime;
            const timeTakenMinutes = Math.floor(timeTakenMs / 60000);
            
            return {
                totalQuestions: exam.questions.length,
                correctAnswers,
                incorrectAnswers: exam.questions.length - correctAnswers,
                totalPoints,
                earnedPoints,
                percentage,
                timeTaken: `${timeTakenMinutes} menit`,
                violations: appState.violations
            };
        }

        // Display Results
        function displayResults(results) {
            const exam = appState.exams.find(e => e.id === appState.currentExam);
            
            // Update exam name
            document.getElementById('examName').textContent = exam ? exam.name : 'Unknown';
            
            // Update score
            document.getElementById('scorePercentage').textContent = `${results.percentage}%`;
            
            // Update performance summary
            document.getElementById('totalQuestions').textContent = results.totalQuestions;
            document.getElementById('correctAnswers').textContent = results.correctAnswers;
            document.getElementById('incorrectAnswers').textContent = results.incorrectAnswers;
            document.getElementById('timeTaken').textContent = results.timeTaken;
        }

        // Back to Dashboard Handler
        document.getElementById('backToDashboardBtn').addEventListener('click', () => {
            if (appState.currentUserRole === 'admin') {
                loadAdminDashboard();
                showSection('adminDashboard');
            } else {
                loadStudentDashboard();
                showSection('studentDashboard');
            }
        });

        // Retake Exam Handler
        document.getElementById('retakeExamBtn').addEventListener('click', () => {
            startExam(appState.currentExam);
        });

        // View Result Handler
        function viewResult(resultId) {
            const result = appState.results.find(r => r.id === resultId);
            if (!result) return;
            
            const exam = appState.exams.find(e => e.id === result.examId);
            if (!exam) return;
            
            // Display results
            const results = {
                totalQuestions: exam.questions.length,
                correctAnswers: Math.round(result.score * exam.questions.length / 100),
                incorrectAnswers: Math.round((100 - result.score) * exam.questions.length / 100),
                percentage: result.score,
                timeTaken: '-'
            };
            
            displayResults(results);
            
            // Update exam name
            document.getElementById('examName').textContent = exam.name;
            
            // Show results section
            showSection('results');
        }

        // Edit Exam Handler
        function editExam(examId) {
            // In a real application, this would open a modal with the exam details
            alert(`Fitur edit ujian dengan ID ${examId} akan segera tersedia`);
        }

        // Delete Exam Handler
        function deleteExam(examId) {
            if (confirm('Apakah Anda yakin ingin menghapus ujian ini?')) {
                appState.exams = appState.exams.filter(e => e.id !== examId);
                saveExamsToStorage();
                loadExamsTable();
            }
        }

        // Edit User Handler
        function editUser(userId) {
            // In a real application, this would open a modal with the user details
            alert(`Fitur edit pengguna dengan ID ${userId} akan segera tersedia`);
        }

        // Delete User Handler
        function deleteUser(userId) {
            if (confirm('Apakah Anda yakin ingin menghapus pengguna ini?')) {
                appState.users = appState.users.filter(u => u.id !== userId);
                saveUsersToStorage();
                loadUsersTable();
            }
        }

        // Anti-Cheating Mechanisms
        function setupAntiCheating() {
            // Page visibility change
            document.addEventListener('visibilitychange', handleVisibilityChange);
            
            // Window focus/blur
            window.addEventListener('blur', handleWindowBlur);
            window.addEventListener('focus', handleWindowFocus);
            
            // Before unload
            window.addEventListener('beforeunload', handleBeforeUnload);
            
            // Fullscreen change
            document.addEventListener('fullscreenchange', handleFullscreenChange);
            document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
            document.addEventListener('mozfullscreenchange', handleFullscreenChange);
            document.addEventListener('MSFullscreenChange', handleFullscreenChange);
            
            // Context menu (right-click)
            document.addEventListener('contextmenu', e => {
                e.preventDefault();
                handleViolation('Mencoba menggunakan menu konteks');
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', e => {
                // Prevent Alt+Tab
                if (e.altKey && e.key === 'Tab') {
                    e.preventDefault();
                    handleViolation('Mencoba beralih aplikasi');
                }
                
                // Prevent F12 (Developer Tools)
                if (e.key === 'F12') {
                    e.preventDefault();
                    handleViolation('Mencoba membuka developer tools');
                }
                
                // Prevent Ctrl+Shift+I (Developer Tools)
                if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                    e.preventDefault();
                    handleViolation('Mencoba membuka developer tools');
                }
                
                // Prevent Ctrl+Shift+J (Console)
                if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                    e.preventDefault();
                    handleViolation('Mencoba membuka konsol');
                }
                
                // Prevent Ctrl+Shift+C (Element Inspector)
                if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                    e.preventDefault();
                    handleViolation('Mencoba inspeksi elemen');
                }
                
                // Prevent Ctrl+U (View Source)
                if (e.ctrlKey && e.key === 'u') {
                    e.preventDefault();
                    handleViolation('Mencoba melihat sumber halaman');
                }
                
                // Prevent Escape key
                if (e.key === 'Escape') {
                    e.preventDefault();
                    handleViolation('Mencoba keluar dari ujian');
                }
                
                // Prevent Windows key
                if (e.key === 'Meta') {
                    e.preventDefault();
                    handleViolation('Mencoba membuka menu Start');
                }
            });
            
            // Prevent copy/paste
            document.addEventListener('copy', e => {
                e.preventDefault();
                handleViolation('Mencoba menyalin konten');
            });
            
            document.addEventListener('paste', e => {
                e.preventDefault();
                handleViolation('Mencoba menempel konten');
            });
            
            // Prevent print
            window.addEventListener('beforeprint', e => {
                e.preventDefault();
                handleViolation('Mencoba mencetak halaman');
            });
        }

        // Remove Anti-Cheating Event Listeners
        function removeAntiCheating() {
            document.removeEventListener('visibilitychange', handleVisibilityChange);
            window.removeEventListener('blur', handleWindowBlur);
            window.removeEventListener('focus', handleWindowFocus);
            window.removeEventListener('beforeunload', handleBeforeUnload);
            document.removeEventListener('fullscreenchange', handleFullscreenChange);
            document.removeEventListener('webkitfullscreenchange', handleFullscreenChange);
            document.removeEventListener('mozfullscreenchange', handleFullscreenChange);
            document.removeEventListener('MSFullscreenChange', handleFullscreenChange);
            document.removeEventListener('contextmenu', e => e.preventDefault());
            document.removeEventListener('copy', e => e.preventDefault());
            document.removeEventListener('paste', e => e.preventDefault());
            window.removeEventListener('beforeprint', e => e.preventDefault());
        }

        // Handle Visibility Change
        function handleVisibilityChange() {
            if (document.hidden && sections.exam.classList.contains('active')) {
                handleViolation('Beralih dari halaman ujian');
            }
        }

        // Handle Window Blur
        function handleWindowBlur() {
            if (sections.exam.classList.contains('active')) {
                handleViolation('Jendela ujian kehilangan fokus');
            }
        }

        // Handle Window Focus
        function handleWindowFocus() {
            // Just log focus regained - violations are counted on blur
        }

        // Handle Before Unload
        function handleBeforeUnload(e) {
            if (sections.exam.classList.contains('active')) {
                e.preventDefault();
                e.returnValue = 'Anda sedang dalam ujian. Apakah Anda yakin ingin keluar?';
                return e.returnValue;
            }
        }

        // Handle Fullscreen Change
        function handleFullscreenChange() {
            if (sections.exam.classList.contains('active')) {
                if (document.fullscreenElement || document.webkitFullscreenElement || 
                    document.mozFullScreenElement || document.msFullscreenElement) {
                    handleViolation('Mencoba masuk mode fullscreen');
                }
            }
        }

        // Handle Violation
        function handleViolation(reason) {
            appState.violations++;
            
            // Show fullscreen prevention
            showFullscreenPrevention(reason);
            
            // Check if user should be banned
            if (appState.violations >= 3) {
                // Ban user
                banUser();
            }
        }

        // Show Fullscreen Prevention
        function showFullscreenPrevention(reason) {
            const message = document.querySelector('.fullscreen-message');
            message.innerHTML = `
                <h2>Terdeteksi Percobaan Kecurangan</h2>
                <p>${reason}</p>
                <p>Ini adalah pelanggaran aturan ujian. Anda akan dikembalikan ke ujian dalam <span id="countdown">10</span> detik.</p>
                <p>Pelanggaran: ${appState.violations}/3</p>
            `;
            
            fullscreenPrevention.classList.add('active');
            
            // Countdown
            let countdown = 10;
            const countdownElement = document.getElementById('countdown');
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    fullscreenPrevention.classList.remove('active');
                }
            }, 1000);
        }

        // Ban User
        function banUser() {
            appState.isBanned = true;
            localStorage.setItem('isBanned', 'true');
            
            // Clear exam timer
            clearInterval(appState.examTimer);
            
            // Remove anti-cheating event listeners
            removeAntiCheating();
            
            // Show ban section
            showSection('ban');
        }

        // Exit Code Modal
        document.getElementById('closeExitModal').addEventListener('click', () => {
            exitCodeModal.classList.remove('active');
        });

        document.getElementById('cancelExitBtn').addEventListener('click', () => {
            exitCodeModal.classList.remove('active');
        });

        document.getElementById('confirmExitBtn').addEventListener('click', () => {
            const exitCode = document.getElementById('exitCode').value;
            
            // Check exit code (in a real app, this would be validated on the server)
            if (exitCode === 'EXIT123') {
                // Clear exam timer
                clearInterval(appState.examTimer);
                
                // Remove anti-cheating event listeners
                removeAntiCheating();
                
                // Return to dashboard
                if (appState.currentUserRole === 'admin') {
                    loadAdminDashboard();
                    showSection('adminDashboard');
                } else {
                    loadStudentDashboard();
                    showSection('studentDashboard');
                }
                
                // Reset modal
                document.getElementById('exitCode').value = '';
                exitCodeModal.classList.remove('active');
            } else {
                showAlert('exitCodeAlert', 'Kode keamanan salah. Silakan coba lagi.', 'danger');
            }
        });

        // Unlock Form Handler
        document.getElementById('unlockForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const unlockCode = document.getElementById('unlockCode').value;
            
            // Check unlock code (in a real app, this would be validated on the server)
            if (unlockCode === 'UNLOCK123') {
                // Unban user
                appState.isBanned = false;
                localStorage.removeItem('isBanned');
                
                // Reset violations
                appState.violations = 0;
                
                // Show dashboard
                if (appState.currentUserRole === 'admin') {
                    loadAdminDashboard();
                    showSection('adminDashboard');
                } else {
                    loadStudentDashboard();
                    showSection('studentDashboard');
                }
                
                showAlert('banAlert', 'Akun Anda berhasil dibuka. Harap patuhi aturan ujian.', 'success');
            } else {
                showAlert('banAlert', 'Kode registrasi salah. Silakan coba lagi.', 'danger');
            }
        });
    </script>
</body>
</html>
